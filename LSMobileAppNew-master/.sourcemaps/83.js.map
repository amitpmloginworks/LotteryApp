{"version":3,"sources":["../../src/pages/confirm-offer-purchase/confirm-offer-purchase.module.ts","../../src/pages/confirm-offer-purchase/confirm-offer-purchase.ts"],"names":[],"mappings":"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","file":"83.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { confirmOfferPurchasePage } from './confirm-offer-purchase';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    confirmOfferPurchasePage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(confirmOfferPurchasePage),\r\n  ],\r\n  exports: [\r\n    confirmOfferPurchasePage\r\n  ]\r\n})\r\nexport class ConfirmOfferPurchasePageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/confirm-offer-purchase/confirm-offer-purchase.module.ts","\r\n\r\nimport { Component, Input, Output, EventEmitter, SimpleChange, OnChanges } from '@angular/core';\r\nimport { LoadingController, AlertController, IonicPage, NavController } from 'ionic-angular';\r\nimport { InAppBrowser } from '@ionic-native/in-app-browser';\r\n\r\nimport { OfferService } from '../../services/offer.service';\r\nimport { Params } from '../../services/params';\r\n\r\nimport { AppSoundProvider } from '../../providers/app-sound/app-sound';\r\n\r\n@IonicPage()\r\n@Component({\r\n    selector: 'page-confirm-offer-purchase',\r\n    templateUrl: 'confirm-offer-purchase.html'\r\n})\r\nexport class confirmOfferPurchasePage implements OnChanges {\r\n    slideInUp: boolean = false;\r\n    confirmPayment: boolean = false;\r\n    showBuyNowView: boolean = false;\r\n    confirmPaymentSuccess: boolean = true;\r\n\r\n    public cardSelected: any\r\n    public cardsValue: any\r\n    public cardsList: any[]\r\n\r\n    public customerDetails\r\n    public syndicate = {\r\n        syndicate_name: \"\",\r\n        total_cost: 0.00\r\n    }\r\n    public offer = {\r\n        syndicate_name: \"\",\r\n        total_cost: 0.00\r\n    }\r\n\r\n    @Output() onPaymentComplete = new EventEmitter();\r\n\r\n    @Input('existing-cards') existingPaymilCards;\r\n\r\n    ngOnChanges(changes: { [propName: string]: SimpleChange }) {\r\n        // console.log('Change detected:', changes[\"existingPaymilCards\"]);\r\n\r\n        if (changes[\"existingPaymilCards\"] && changes[\"existingPaymilCards\"].currentValue) {\r\n            this.cardsValue = changes[\"existingPaymilCards\"].currentValue;\r\n\r\n            console.log(\"existingPaymilCards\", this.cardsValue);\r\n\r\n            for (var i = 0; i < this.cardsValue.length; ++i) {\r\n\r\n                console.log(\"existingPaymilCards\", this.cardsValue[i]);\r\n\r\n                if (this.cardsValue[i].get_customer_paymill_card_details) {\r\n                    this.cardsList = this.cardsValue[i].get_customer_paymill_card_details.response.cards\r\n                } else if (this.cardsValue[i].get_customer_details) {\r\n                    this.customerDetails = this.cardsValue[i].get_customer_details.response\r\n                } else if (this.cardsValue[i].offer) {\r\n                    this.syndicate = this.cardsValue[i].offer\r\n                } else if (this.cardsValue[i].syndicate) {\r\n                    this.syndicate = this.cardsValue[i].syndicate\r\n\r\n                }\r\n            }\r\n\r\n            // console.log(\"cardsList\", this.cardsList );\r\n            // console.log(\"customerDetails\", this.customerDetails );\r\n\r\n        }\r\n    }\r\n\r\n    constructor(\r\n        private params: Params,\r\n        private iab: InAppBrowser,\r\n        public srvOffer: OfferService,\r\n        public navCtrl: NavController,\r\n        public alertCtrl: AlertController,\r\n        public appSound: AppSoundProvider,\r\n        public loadingCtrl: LoadingController) {\r\n        console.log('Hello PopupConfirmPaymentComponent Component');\r\n    }\r\n\r\n    buyNow() {\r\n        console.log(\"PopupConfirmPaymentComponent::buyNow\", this.cardSelected);\r\n        this.appSound.play('buttonClick');\r\n\r\n        if (this.cardSelected == '-1') {\r\n            let opt: string = \"location=no,toolbarposition=top\";\r\n            let str = 'https://nima.lottosocial.com/webview-auth/?redirect_to=free_reg&customer_id=1970400&customer_token=818113679640&Offer_ID=1188'\r\n\r\n            // this.showBuyNowView = !this.showBuyNowView\r\n            this.iab.create(str, 'blank', opt);\r\n        } else {\r\n            this.makeCardPayment(this.cardSelected);\r\n        }\r\n    }\r\n\r\n    makeCardPayment(selectedCardIndex) {\r\n        this.appSound.play('buttonClick');\r\n        let loader = this._showLoader();\r\n        if (!selectedCardIndex) {\r\n            let alert = this.alertCtrl.create({\r\n                title: \"Error!\",\r\n                subTitle: \"Please select any option to make a payment\",\r\n                buttons: ['Dismiss']\r\n            });\r\n            alert.present();\r\n        }\r\n\r\n        let card = this.cardsList[parseInt(selectedCardIndex)]\r\n\r\n        console.log(\"PopupConfirmPaymentComponent::makeCardPayment\", selectedCardIndex, card)\r\n\r\n        if (card) {\r\n            this.srvOffer.processPaymillCardPayment(this.syndicate, this.customerDetails, card).subscribe((data) => {\r\n                console.log(\"PopupConfirmPaymentComponent::checkCardExists() success\", data);\r\n                loader.dismiss();\r\n\r\n                this.showBuyNowView = true;\r\n                data = data.response[0];\r\n                if (data.process_paymill_card_payment) {\r\n                    data = data.process_paymill_card_payment.response\r\n                    this.confirmPaymentSuccess = (data.status == \"SUCCESS\")\r\n                }\r\n\r\n                if (this.onPaymentComplete) {\r\n                    this.onPaymentComplete.emit();\r\n                }\r\n            }, (err) => {\r\n                console.log(\"PopupConfirmPaymentComponent::checkCardExists() error\", err);\r\n                this.confirmPaymentSuccess = false\r\n                this.appSound.play('Error');\r\n                this.params.setIsInternetAvailable(false)\r\n            })\r\n        }\r\n    }\r\n\r\n    private try_again() {\r\n        this.appSound.play('buttonClick');\r\n        this.togglePopup();\r\n        this.confirmPaymentSuccess = true\r\n        this.showBuyNowView = false;\r\n    }\r\n\r\n    viewTickets() {\r\n        this.appSound.play('buttonClick');\r\n        this.togglePopup();\r\n        //this.navCtrl.setRoot('HomePage')\r\n        this.params.goTab(1);\r\n        this.showBuyNowView = false;\r\n    }\r\n\r\n    viewOffers() {\r\n        this.appSound.play('buttonClick');\r\n        this.togglePopup();\r\n        this.params.goTab(4);\r\n        this.showBuyNowView = false;\r\n    }\r\n\r\n\r\n    public togglePopup() {\r\n        console.log(\"showWhatsOn: \" + this.slideInUp);\r\n\r\n        if (this.slideInUp) {\r\n            let timeoutId = setTimeout(() => {\r\n                this.confirmPayment = !this.confirmPayment;\r\n                clearTimeout(timeoutId);\r\n            }, 500);\r\n            this.slideInUp = !this.slideInUp;\r\n        } else {\r\n            this.confirmPayment = !this.confirmPayment;\r\n            let timeoutId = setTimeout(() => {\r\n\r\n                this.slideInUp = !this.slideInUp;\r\n                clearTimeout(timeoutId);\r\n\r\n            }, 10);\r\n        }\r\n    }\r\n\r\n    private _showLoader() {\r\n        let loader = this.loadingCtrl.create({\r\n            content: \"Saving data...\"\r\n        });\r\n        loader.present()\r\n        return loader;\r\n    }\r\n\r\n\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/confirm-offer-purchase/confirm-offer-purchase.ts"],"sourceRoot":""}