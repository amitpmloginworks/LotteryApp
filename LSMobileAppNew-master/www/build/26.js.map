{"version":3,"sources":["../../src/pages/splash/splash.module.ts","../../src/pages/splash/splash.ts"],"names":[],"mappings":"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","file":"26.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { SplashPage } from './splash';\n\n\n@NgModule({\n  declarations: [\n    SplashPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(SplashPage),\n  ],\n  exports:[SplashPage]\n})\nexport class SplashPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/splash/splash.module.ts","import { Component } from '@angular/core';\nimport { NavController, NavParams, IonicPage } from 'ionic-angular';\n\nimport { WelcomePage } from '../welcome/welcome';\nimport { HomePage } from '../home/home';\nimport { AuthService } from '../../services/auth.service';\nimport { Storage } from '@ionic/storage';\nimport { CommonService } from '../../services/common.service';\n\n@IonicPage()\n@Component({\n    selector: 'page-splash',\n    templateUrl: 'splash.html'\n})\nexport class SplashPage {\n\n    constructor(\n        private storage: Storage,\n        private authSrv: AuthService,\n        public navCtrl: NavController,\n        public navParams: NavParams) {\n\n        //check the storage is ready or not    \n        this.storage.ready().then(() => {\n            var email;\n            var passWord;\n            var newDate;\n            var tokenTime\n            var dateTimeNow = new Date();\n\n            this.storage.get('DF_EMAIL').then((val) => {\n                console.log(\"splash df email\", val)\n                email = val;\n            });\n            this.storage.get('DF_PASSWORD').then((val) => {\n                console.log(\"splash df password\", val)\n                passWord = val;\n            });\n            this.storage.get('session_token_time').then((val) => {\n                console.log(\"token expiry time\", val)\n                if (val) {\n                    newDate = new Date(val)\n                    tokenTime = newDate;\n                }\n            });\n            this.storage.get('session').then((val) => {\n                CommonService.session = JSON.parse(val);\n                console.log('Your session is', val);\n\n                setTimeout(() => {\n                    //Checking the user token(DF credentials)\n                    if (email) {\n                        //Checking the if token is valid or not\n                        if (dateTimeNow < newDate) {\n                            this.storage.get('session_ID').then((val) => {\n                                CommonService.sessionId = val;\n                            });\n\n                            this.storage.get('user_session_id').then((val) => {\n                                CommonService.userSessionId = val;\n                            });\n\n                            this.storage.get('user_session_token').then((val) => {\n                                CommonService.userSessionToken = val;\n\n                            });\n\n                            //if valid then setting the home page as root \n                            setTimeout(() => {\n                                this.navCtrl.setRoot('HomePage');\n                            }, 0);\n\n                        }\n                        //in case if no time is existed for the token expiry\n                        else if (!tokenTime) {\n                            this.storage.remove('session_token_time')\n                            this.storage.remove('user_session_token')\n                            CommonService.JWT = \"\";\n                            this.navCtrl.setRoot(WelcomePage);\n                        }\n                        else {\n                            //in case if token is expired\n                            var datetime = new Date();\n                            datetime.setHours(datetime.getHours() + 10)\n                            this.authSrv.getJWTToken(email, passWord).subscribe(\n                                successData => {\n                                    console.log(\"retrived the new data for JWT\", successData)\n                                    this.storage.set('session_ID', CommonService.sessionId);\n                                    this.storage.set('user_session_token', successData.session_token);\n                                    this.storage.set('user_session_id', successData.session_id);\n                                    this.storage.set('session_token_time', datetime)\n                                    CommonService.JWT = successData.session_token;\n\n                                    this.storage.get('session_ID').then((val) => {\n                                        CommonService.sessionId = val;\n                                    });\n\n                                    this.storage.get('user_session_id').then((val) => {\n                                        CommonService.userSessionId = val;\n                                    });\n\n                                    this.storage.get('user_session_token').then((val) => {\n                                        CommonService.userSessionToken = val;\n                                    });\n                                    setTimeout(() => {\n                                        this.navCtrl.setRoot('HomePage');\n                                    }, 500);\n                                },\n                                error => {\n                                    console.log(\"user login error\", error);\n                                },\n                                () => { }\n                            );\n                        }\n                    }\n                    else {\n                        //if no user token then setting to welcome page\n                        this.storage.remove('session_token_time')\n                        this.storage.remove('user_session_token')\n                        CommonService.JWT = \"\";\n                        this.navCtrl.setRoot(WelcomePage);\n                    }\n\n\n                }, 0);\n            });\n\n        });\n\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/splash/splash.ts"],"sourceRoot":""}